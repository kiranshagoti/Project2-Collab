<a href="/auth/logout">logout</a>

<div class="createDash">
  <button class="createItem" onclick="createNewItem()">New item</button>
  <form id="taskForm" action="/dashboard" method="post" enctype="multipart/form-data"></form>
</div>

{{#each tasks}}
<form id="taskForm" action="/dashboard/{{this._id}}" method="post" enctype="multipart/form-data">
  <input type="text" placeholder="Add task name" name="name" value="{{this.name}}" />

  <select name="responsible">
    <option value="{{this.responsible}}" hidden="hidden" selected="selected">{{this.responsible}}</option>
    {{#each ../names}}
    <option>{{username}}</option>
    {{/each}}
  </select>

  <select name="status">
    <option value="{{this.status}}" hidden="hidden" selected="selected">{{this.status}}</option>
    <option>Stuck</option>
    <option>Working on it</option>
    <option>Done</option>
    <option>Waiting for review</option>
  </select>


  <input type="date" name="dueDate" value="{{this.dueDate}}" />

  <select name="priority">
    <option value="{{this.priority}}" hidden="hidden" selected="selected">{{this.priority}}</option>
    <option>Urgent</option>
    <option>High</option>
    <option>Medium</option>
    <option>Low</option>
  </select>



  <input type="text" placeholder="Add a comment" name="comment" value="{{this.comment}}" />
  <span>uploadet file: <a href="">{{this.files.name}}</a></span>


</form>
<form action="/dashboard/delete/{{this._id}}" method="post">
       <button type="submit">Delete</button>
</form>

{{/each}}


{{!-- <a href="/dashboard">Add task</a> --}}

<script>
  function createNewItem() {
    document.querySelector('#taskForm').innerHTML +=
      `
      <input type="text" placeholder="Add task name" name="name"/>
      
      <select name="responsible">
    <option></option>
    {{#each names}}
    <option>{{username}}</option>
    {{/each}}
  </select>

  <select name="status">
    <option></option>
    <option>Stuck</option>
    <option>Working on it</option>
    <option>Done</option>
    <option>Waiting for review</option>
  </select>
  
  <input type="date" name="dueDate"/>

 <select name="priority">
    <option></option>
    <option>Urgent</option>
    <option>High</option>
    <option>Medium</option>
    <option>Low</option>
  </select>

  <input type="text" placeholder="Add a comment" name="comment"/>
  <input type="file" name="files"/>
      `
    document.querySelectorAll(".formBtn").forEach(elem => elem.remove())
    let createBtn = document.createElement('button');
    createBtn.setAttribute("type", "submit")
    createBtn.classList.add("formBtn")
    createBtn.innerText = "Save"
    let dashForm = document.querySelector("#taskForm")

    dashForm.appendChild(createBtn)
  }
</script>